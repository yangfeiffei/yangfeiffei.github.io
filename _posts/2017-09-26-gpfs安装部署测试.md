---
layout: post
title: GPFS安装部署测试
date: 2017-09-26 21:00
author: felo
tags: centos gpfs
---


# 0.环境准备和规划

ID | hostname | IP Address |   disk  | other
---|----------|------------|---------|---------
1  |    c01   | 10.10.1.173| sda:20GB|
2  |    c02   | 10.10.1.174| sda:20GB|
3  |    c03   | 10.10.1.175| sda:20GB|


uname:
```bash
[root@c01 ~]# uname -r
2.6.32-431.el6.x86_64
[root@c01 ~]# cat /etc/redhat-release
CentOS release 6.5 (Final)
```

修改hosts表：
```
[root@c01 ~]# echo "10.10.1.173 c01" >> /etc/hosts
[root@c01 ~]# echo "10.10.1.174 c02" >> /etc/hosts
[root@c01 ~]# echo "10.10.1.175 c03" >> /etc/hosts
[root@c01 ~]# cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
10.10.1.173 c01
10.10.1.174 c02
10.10.1.175 c03
```

# 1.安装部署

在三个节点安装下面的内容

准备安装包：
```bash
[root@c01 3.5]# yum -y install unzip
[root@c01 3.5]# yum -y groupinstall "Desktop"
[root@c01 3.5]# unzip gpfs_install-3.5.zip
```
在图形界面下执行解压后的压缩包gpfs_install-3.5.0-0_x86_64，接受许可。

```bash
[root@c01 ~]# cd /usr/lpp/mmfs/3.5/
[root@c01 3.5]# ls -l
total 12952
-rw-r--r-- 1 root root 12405953 Jan 19  2013 gpfs.base-3.5.0-3.x86_64.rpm
-rw-r--r-- 1 root root   230114 Jan 19  2013 gpfs.docs-3.5.0-3.noarch.rpm
-rw-r--r-- 1 root root   509477 Jan 19  2013 gpfs.gpl-3.5.0-3.noarch.rpm
-rw-r--r-- 1 root root    99638 Jan 19  2013 gpfs.msg.en_US-3.5.0-3.noarch.rpm
drwxr-xr-x 2 root root     4096 Sep 27 06:31 license
-rw-r--r-- 1 root root       39 Sep 27 06:31 status.dat
[root@c01 ~]# yum -y install ksh
...
[root@c01 3.5]# rpm -ivh gpfs.base-3.5.0-3.x86_64.rpm
Preparing...                ########################################### [100%]
   1:gpfs.base              ########################################### [100%]
[root@c01 3.5]# rpm -ivh *.rpm
Preparing...                ########################################### [100%]
        package gpfs.base-3.5.0-3.x86_64 is already installed
[root@c01 3.5]# rpm -ivh gpfs.docs-3.5.0-3.noarch.rpm
Preparing...                ########################################### [100%]
   1:gpfs.docs              ########################################### [100%]
[root@c01 3.5]# rpm -ivh gpfs.gpl-3.5.0-3.noarch.rpm
Preparing...                ########################################### [100%]
   1:gpfs.gpl               ########################################### [100%]
[root@c01 3.5]# rpm -ivh gpfs.msg.en_US-3.5.0-3.noarch.rpm
Preparing...                ########################################### [100%]
   1:gpfs.msg.en_US         ########################################### [100%]
```
编译和安装GPL层二进制文件

```bash
[root@c02 ~]# cd /usr/lpp/mmfs/src/
[root@c01 src]# yum -y install cpp gcc gcc-c++
...

[root@c01 src]# make LINUX_DISTRIBUTION=REDHAT_AS_LINUX Autoconfig World InstallImages \
2>/tmp/make_err 1>/tmp/make_out

# 验证
[root@c01 src]# ls -al /lib/modules/2.6.32-696.10.2.el6.x86_64/extra/
total 6016
drwxr-xr-x 2 root root    4096 Sep 27 07:08 .
drwxr-xr-x 7 root root    4096 Sep 27 07:08 ..
-rw-r--r-- 1 root root 2894349 Sep 27 07:08 mmfs26.ko
-rw-r--r-- 1 root root 2547296 Sep 27 07:08 mmfslinux.ko
-rw-r--r-- 1 root root  708128 Sep 27 07:08 tracedev.ko

```



# 2.测试



